<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CursoPropioDAO.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Gestor_titulos_propios</a> &gt; <a href="index.source.html" class="el_package">persistencia</a> &gt; <span class="el_source">CursoPropioDAO.java</span></div><h1>CursoPropioDAO.java</h1><pre class="source lang-java linenums">package persistencia;

import java.sql.SQLException;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Iterator;
import java.util.List;
import java.util.Vector;
import java.util.ArrayList;

import negocio.entities.*;

<span class="fc" id="L15">public class CursoPropioDAO {</span>

<span class="fc" id="L17">	private DateFormat dateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd hh:mm:ss&quot;);</span>
	
	public int crearNuevoCurso(CursoPropio curso) throws SQLException {
<span class="fc" id="L20">		Date fechaCreacion =  new Date();</span>
<span class="fc" id="L21">		Date fechaActualizacion = fechaCreacion;</span>

<span class="fc" id="L23">		int contador = 0;</span>
		
<span class="fc" id="L25">		contador += GestorBD.getInstancia().insert(&quot;INSERT INTO cursoPropio (id, nombre, ECTS, fechaInicio, fechaFin, tasaMatricula, edicion, estadoCurso, tipoCurso, centro_nombre, secretario_Profesor_DNI, director_Profesor_DNI, requisitos, fechaCreacion, fechaActualizacion) VALUES ('&quot;</span>
<span class="fc" id="L26">				+ curso.getId()+&quot;', '&quot;</span>
<span class="fc" id="L27">				+ curso.getNombre()+&quot;', &quot;</span>
<span class="fc" id="L28">				+ curso.getECTS()+&quot;, '&quot;</span>
<span class="fc" id="L29">				+ dateFormat.format(curso.getFechaInicio())+&quot;', '&quot;</span>
<span class="fc" id="L30">				+ dateFormat.format(curso.getFechaFin())+&quot;', &quot;</span>
<span class="fc" id="L31">				+ curso.getTasaMatricula()+&quot;, &quot;</span>
<span class="fc" id="L32">				+ curso.getEdicion()+&quot;, '&quot;</span>
<span class="fc" id="L33">				+ curso.estado.toString()+&quot;', '&quot;</span>
<span class="fc" id="L34">				+ curso.tipo.toString()+&quot;', '&quot;</span>
<span class="fc" id="L35">				+ curso.centro.getNombre()+&quot;', '&quot;</span>
<span class="fc" id="L36">				+ curso.secretario.getDni()+&quot;', '&quot;</span>
<span class="fc" id="L37">				+ curso.director.getDni()+&quot;', '&quot;</span>
				+ curso.requisitos+&quot;', '&quot;
<span class="fc" id="L39">				+ dateFormat.format(fechaCreacion)+&quot;', '&quot;</span>
<span class="fc" id="L40">				+ dateFormat.format(fechaActualizacion)+&quot;')&quot;);</span>
		
<span class="fc" id="L42">		Materia[] materias = curso.materias.toArray(new Materia[curso.materias.size()]);</span>

<span class="fc bfc" id="L44" title="All 2 branches covered.">		for (int i=0; i&lt;materias.length; i++){</span>
<span class="fc" id="L45">			contador += materias[i].materiaDao.crearNuevaMateria(materias[i], curso.getId(), curso.getEdicion());</span>
		}
		
<span class="pc bpc" id="L48" title="1 of 2 branches missed.">		if (contador == curso.materias.size() + 1){</span>
<span class="fc" id="L49">			return 1;	</span>
		} else {
<span class="nc" id="L51">			return 0;</span>
		}
	}

	public CursoPropio seleccionarCurso(CursoPropio curso) throws SQLException, ParseException {
<span class="nc" id="L56">		Vector datosCurso = GestorBD.getInstancia().select(&quot;SELECT * FROM cursoPropio WHERE id='&quot;+curso.getId()+&quot;' AND edicion=&quot;+curso.getEdicion());</span>
<span class="nc" id="L57">		datosCurso = (Vector) datosCurso.get(0);</span>
		
<span class="nc" id="L59">		String id = (String) datosCurso.get(0);</span>
<span class="nc" id="L60">		String nombre = (String) datosCurso.get(1);</span>
<span class="nc" id="L61">		int ECTS = (Integer) datosCurso.get(2);</span>
<span class="nc" id="L62">		Date fechainicio = (Date) datosCurso.get(3);</span>
<span class="nc" id="L63">		Date fechafin = (Date) datosCurso.get(4);</span>
<span class="nc" id="L64">		double tasaMatricula = (Double) datosCurso.get(5);</span>
<span class="nc" id="L65">		int edicion = (Integer) datosCurso.get(6);</span>
<span class="nc" id="L66">		EstadoCurso estado = EstadoCurso.valueOf((String) datosCurso.get(7));</span>
<span class="nc" id="L67">		TipoCurso tipo = TipoCurso.valueOf((String) datosCurso.get(8));</span>
<span class="nc" id="L68">		Centro centro = new Centro((String) datosCurso.get(9));</span>
<span class="nc" id="L69">		ProfesorUCLM secretario = new ProfesorUCLM((String) datosCurso.get(10));</span>
<span class="nc" id="L70">		ProfesorUCLM director = new ProfesorUCLM((String) datosCurso.get(11));</span>
<span class="nc" id="L71">		String requisitos = (String) datosCurso.get(12);</span>
		
<span class="nc" id="L73">		CursoPropio cursoDevolver = new CursoPropio(id, nombre, ECTS, fechainicio, fechafin, tasaMatricula, edicion, estado, tipo, centro, secretario, director, requisitos);</span>
		
<span class="nc" id="L75">		List&lt;Materia&gt; materiasCurso = new Materia().materiaDao.listarMateriasPorCurso(cursoDevolver);</span>
<span class="nc" id="L76">		cursoDevolver.materias = materiasCurso;</span>
		
<span class="nc" id="L78">		List&lt;Matricula&gt; matriculasCurso = new Matricula().matriculaDAO.listarMatriculasPorCurso(cursoDevolver);</span>
<span class="nc" id="L79">		cursoDevolver.matriculas = matriculasCurso;</span>
		
<span class="nc" id="L81">		return cursoDevolver;</span>
	}

	public int editarCurso(CursoPropio curso) throws SQLException, ParseException {
		//HABLAR CON RICARDO: el return type se ha cambiado a integer, originalmente era CursoPropio
<span class="nc" id="L86">		Date fechaActualizacion = new Date();</span>

<span class="nc" id="L88">		int contador = 0;</span>
<span class="nc" id="L89">		int materiasAModificar = 0;</span>
		
<span class="nc" id="L91">		CursoPropio cursoEnBBDD = curso.cursoPropioDao.seleccionarCurso(curso);</span>
		
		//curso.materias y cursoEnBBDD.materias
		
		//comprobar los nuevos a a√±adir
<span class="nc" id="L96">		System.out.println(curso.materias);</span>
		
<span class="nc" id="L98">		Iterator&lt;Materia&gt; recorrerMateriaCurso = curso.materias.iterator();</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">		while(recorrerMateriaCurso.hasNext()) {</span>
<span class="nc" id="L100">			boolean materiaYaEnBBDD = false;</span>
<span class="nc" id="L101">			Materia materiaCurso = recorrerMateriaCurso.next();</span>
			
<span class="nc" id="L103">			Iterator&lt;Materia&gt; recorrerMateriaCursoEnBBDD = cursoEnBBDD.materias.iterator();</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">			while(recorrerMateriaCursoEnBBDD.hasNext()) {</span>
<span class="nc" id="L105">				Materia materiaCursoEnBBDD = recorrerMateriaCursoEnBBDD.next();</span>
<span class="nc bnc" id="L106" title="All 2 branches missed.">				if (materiaCurso.getNombre().equals(materiaCursoEnBBDD.getNombre())) {</span>
<span class="nc" id="L107">					materiaYaEnBBDD = true;</span>
<span class="nc" id="L108">					break;</span>
				}
<span class="nc" id="L110">			}</span>
			
<span class="nc bnc" id="L112" title="All 2 branches missed.">			if (!materiaYaEnBBDD) {</span>
<span class="nc" id="L113">				materiasAModificar++;</span>
<span class="nc" id="L114">				contador += materiaCurso.materiaDao.crearNuevaMateria(materiaCurso, curso.getId(), curso.getEdicion());</span>
			}
<span class="nc" id="L116">		}</span>
		
		
		//comprobar los antiguos a borrar	
<span class="nc" id="L120">		Iterator&lt;Materia&gt; recorrerMateriaCursoEnBBDD = cursoEnBBDD.materias.iterator();</span>
<span class="nc bnc" id="L121" title="All 2 branches missed.">		while(recorrerMateriaCursoEnBBDD.hasNext()) {</span>
<span class="nc" id="L122">			boolean materiaSeMantiene = false;</span>
<span class="nc" id="L123">			Materia materiaCursoEnBBDD = recorrerMateriaCursoEnBBDD.next();</span>
			
<span class="nc" id="L125">			Iterator&lt;Materia&gt; recorrerMateriaCurso2 = curso.materias.iterator();</span>
<span class="nc bnc" id="L126" title="All 2 branches missed.">			while(recorrerMateriaCurso2.hasNext()) {</span>
<span class="nc" id="L127">				Materia materiaCurso = recorrerMateriaCurso2.next();</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">				if (materiaCursoEnBBDD.getNombre().equals(materiaCurso.getNombre())) {</span>
<span class="nc" id="L129">					materiaSeMantiene = true;</span>
<span class="nc" id="L130">					break;</span>
				}
<span class="nc" id="L132">			}</span>
			
<span class="nc bnc" id="L134" title="All 2 branches missed.">			if (!materiaSeMantiene) {</span>
<span class="nc" id="L135">				materiasAModificar++;</span>
<span class="nc" id="L136">				contador += materiaCursoEnBBDD.materiaDao.eliminarMateria(materiaCursoEnBBDD, curso.getId(), curso.getEdicion());</span>
			}
<span class="nc" id="L138">		}</span>
		
<span class="nc" id="L140">		contador+= GestorBD.getInstancia().update(&quot;UPDATE cursoPropio SET &quot;</span>
<span class="nc" id="L141">				+ &quot;nombre='&quot; + curso.getNombre() + &quot;', &quot;</span>
<span class="nc" id="L142">				+ &quot;ECTS=&quot; + curso.getECTS() + &quot;, &quot;</span>
<span class="nc" id="L143">				+ &quot;fechaInicio='&quot; + dateFormat.format(curso.getFechaInicio()) + &quot;', &quot;</span>
<span class="nc" id="L144">				+ &quot;fechaFin='&quot; + dateFormat.format(curso.getFechaFin()) + &quot;', &quot;</span>
<span class="nc" id="L145">				+ &quot;tasaMatricula=&quot; + curso.getTasaMatricula() + &quot;, &quot;</span>
<span class="nc" id="L146">				+ &quot;estadoCurso='&quot; + curso.estado.toString() + &quot;', &quot;</span>
<span class="nc" id="L147">				+ &quot;tipoCurso='&quot; + curso.tipo.toString() + &quot;', &quot;</span>
<span class="nc" id="L148">				+ &quot;centro_nombre='&quot; + curso.centro.getNombre() + &quot;', &quot;</span>
<span class="nc" id="L149">				+ &quot;secretario_Profesor_DNI='&quot; + curso.secretario.getDni() + &quot;', &quot;</span>
<span class="nc" id="L150">				+ &quot;director_Profesor_DNI='&quot; + curso.director.getDni() + &quot;', &quot;</span>
				+ &quot;requisitos='&quot; + curso.requisitos + &quot;', &quot;
<span class="nc" id="L152">				+ &quot;fechaActualizacion='&quot; + dateFormat.format(fechaActualizacion)</span>
<span class="nc" id="L153">				+ &quot;' WHERE id='&quot;+curso.getId()+&quot;' AND edicion=&quot;+curso.getEdicion());</span>
		
<span class="nc bnc" id="L155" title="All 2 branches missed.">		if (contador == materiasAModificar + 1){</span>
<span class="nc" id="L156">			return 1;	</span>
		} else {
<span class="nc" id="L158">			return 0;</span>
		}
	}
	
	public int eliminarCursoPropio(CursoPropio curso) throws SQLException {
<span class="fc" id="L163">		int contador = 0;</span>
		
<span class="fc" id="L165">		Materia[] materias = curso.materias.toArray(new Materia[curso.materias.size()]);</span>
<span class="fc bfc" id="L166" title="All 2 branches covered.">		for (int i=0; i&lt;materias.length; i++){</span>
<span class="fc" id="L167">			contador += materias[i].materiaDao.eliminarMateria(materias[i], curso.getId(), curso.getEdicion());</span>
		}
		
<span class="fc" id="L170">		contador+= GestorBD.getInstancia().delete(&quot;DELETE FROM cursoPropio WHERE id='&quot;+curso.getId()+&quot;' AND edicion=&quot;+curso.getEdicion());</span>
<span class="pc bpc" id="L171" title="1 of 2 branches missed.">		if (contador == curso.materias.size() + 1){</span>
<span class="fc" id="L172">			return 1;	</span>
		} else {
<span class="nc" id="L174">			return 0;</span>
		}
	}

	public List&lt;CursoPropio&gt; listarCursos() throws SQLException {
<span class="fc" id="L179">		Vector cursosDatos=  GestorBD.getInstancia().select(&quot;SELECT * FROM cursoPropio&quot;);</span>
<span class="fc" id="L180">		List &lt;CursoPropio&gt; listaCursos=new ArrayList&lt;&gt;();</span>
		
<span class="fc bfc" id="L182" title="All 2 branches covered.">		for(int i=0; i&lt;cursosDatos.size(); i++) {</span>
<span class="fc" id="L183">			Vector curDatosTemp=(Vector) cursosDatos.get(i);</span>
			
<span class="fc" id="L185">			String id = (String) curDatosTemp.get(0);</span>
<span class="fc" id="L186">			String nombre = (String) curDatosTemp.get(1);</span>
<span class="fc" id="L187">			int ECTS = (Integer)curDatosTemp.get(2);</span>
<span class="fc" id="L188">			Date fechainicio = (Date) curDatosTemp.get(3);</span>
<span class="fc" id="L189">			Date fechafin = (Date) curDatosTemp.get(4);</span>
<span class="fc" id="L190">			double tasaMatricula = (Double) curDatosTemp.get(5);</span>
<span class="fc" id="L191">			int edicion = (Integer) curDatosTemp.get(6);</span>
<span class="fc" id="L192">			EstadoCurso estadoObtenido = EstadoCurso.valueOf((String) curDatosTemp.get(7));</span>
<span class="fc" id="L193">			TipoCurso tipo = TipoCurso.valueOf((String) curDatosTemp.get(8));</span>
<span class="fc" id="L194">			Centro centro = new Centro((String) curDatosTemp.get(9));</span>
<span class="fc" id="L195">			ProfesorUCLM secretario = new ProfesorUCLM((String) curDatosTemp.get(10));</span>
<span class="fc" id="L196">			ProfesorUCLM director = new ProfesorUCLM((String) curDatosTemp.get(11));</span>
<span class="fc" id="L197">			String requisitos = (String) curDatosTemp.get(12);			</span>
			
<span class="fc" id="L199">			CursoPropio cursoDevolver = new CursoPropio(id, nombre, ECTS, fechainicio, fechafin, tasaMatricula, edicion, estadoObtenido, tipo, centro, secretario, director, requisitos);</span>
			
<span class="fc" id="L201">			List&lt;Matricula&gt; matriculasCurso = new Matricula().matriculaDAO.listarMatriculasPorCurso(cursoDevolver);</span>
<span class="fc" id="L202">			cursoDevolver.matriculas = matriculasCurso;</span>
			
<span class="fc" id="L204">			List&lt;Materia&gt; materiasCurso = new Materia().materiaDao.listarMateriasPorCurso(cursoDevolver);</span>
<span class="fc" id="L205">			cursoDevolver.materias = materiasCurso;</span>
			
<span class="fc" id="L207">			listaCursos.add(cursoDevolver);</span>
		}
		
<span class="fc" id="L210">		return listaCursos;</span>

	}

	public List&lt;CursoPropio&gt; listarCursosPorEstado(EstadoCurso estado, Date fechaInicio, Date fechaFin) throws SQLException {
<span class="fc" id="L215">		Vector cursosDatos=  GestorBD.getInstancia().select(&quot;SELECT * FROM cursoPropio WHERE estadoCurso = '&quot;+estado.toString()+&quot;' AND fechaInicio &gt;= '&quot; + dateFormat.format(fechaInicio) + &quot;' AND fechaFin &lt;= '&quot; + dateFormat.format(fechaFin) + &quot;'&quot;);</span>
<span class="fc" id="L216">		List &lt;CursoPropio&gt; listaCursos=new ArrayList&lt;&gt;();</span>
		
<span class="fc bfc" id="L218" title="All 2 branches covered.">		for(int i=0; i&lt;cursosDatos.size(); i++) {</span>
<span class="fc" id="L219">			Vector curDatosTemp=(Vector) cursosDatos.get(i);</span>
			
<span class="fc" id="L221">			String id = (String) curDatosTemp.get(0);</span>
<span class="fc" id="L222">			String nombre = (String) curDatosTemp.get(1);</span>
<span class="fc" id="L223">			int ECTS = (Integer)curDatosTemp.get(2);</span>
<span class="fc" id="L224">			Date fechainicio = (Date) curDatosTemp.get(3);</span>
<span class="fc" id="L225">			Date fechafin = (Date) curDatosTemp.get(4);</span>
<span class="fc" id="L226">			double tasaMatricula = (Double) curDatosTemp.get(5);</span>
<span class="fc" id="L227">			int edicion = (Integer) curDatosTemp.get(6);</span>
<span class="fc" id="L228">			EstadoCurso estadoObtenido = EstadoCurso.valueOf((String) curDatosTemp.get(7));</span>
<span class="fc" id="L229">			TipoCurso tipo = TipoCurso.valueOf((String) curDatosTemp.get(8));</span>
<span class="fc" id="L230">			Centro centro = new Centro((String) curDatosTemp.get(9));</span>
<span class="fc" id="L231">			ProfesorUCLM secretario = new ProfesorUCLM((String) curDatosTemp.get(10));</span>
<span class="fc" id="L232">			ProfesorUCLM director = new ProfesorUCLM((String) curDatosTemp.get(11));</span>
<span class="fc" id="L233">			String requisitos = (String) curDatosTemp.get(12);</span>
			
<span class="fc" id="L235">			CursoPropio cursoDevolver = new CursoPropio(id, nombre, ECTS, fechainicio, fechafin, tasaMatricula, edicion, estadoObtenido, tipo, centro, secretario, director, requisitos);</span>
			
<span class="fc" id="L237">			List&lt;Materia&gt; materiasCurso = new Materia().materiaDao.listarMateriasPorCurso(cursoDevolver);</span>
<span class="fc" id="L238">			cursoDevolver.materias = materiasCurso;</span>
			
<span class="fc" id="L240">			List&lt;Matricula&gt; matriculasCurso = new Matricula().matriculaDAO.listarMatriculasPorCurso(cursoDevolver);</span>
<span class="fc" id="L241">			cursoDevolver.matriculas = matriculasCurso;</span>
			
<span class="fc" id="L243">			listaCursos.add(cursoDevolver);</span>
		}
	
<span class="fc" id="L246">		return listaCursos;	</span>
	}
	
	public List&lt;CursoPropio&gt; listarCursosPorDirector(ProfesorUCLM director, Date fechaInicio, Date fechaFin) throws SQLException {
<span class="fc" id="L250">		Vector cursosDatos=  GestorBD.getInstancia().select(&quot;SELECT * FROM cursoPropio WHERE director_Profesor_DNI = '&quot;+director.getDni()+&quot;' AND fechaInicio &gt;= '&quot; + dateFormat.format(fechaInicio) + &quot;' AND fechaFin &lt;= '&quot; + dateFormat.format(fechaFin) + &quot;'&quot;);</span>
<span class="fc" id="L251">		List &lt;CursoPropio&gt; listaCursos=new ArrayList&lt;&gt;();</span>
		
<span class="fc bfc" id="L253" title="All 2 branches covered.">		for(int i=0; i&lt;cursosDatos.size(); i++) {</span>
<span class="fc" id="L254">			Vector curDatosTemp=(Vector) cursosDatos.get(i);</span>
			
<span class="fc" id="L256">			String id = (String) curDatosTemp.get(0);</span>
<span class="fc" id="L257">			String nombre = (String) curDatosTemp.get(1);</span>
<span class="fc" id="L258">			int ECTS = (Integer) curDatosTemp.get(2);</span>
<span class="fc" id="L259">			Date fechainicio = (Date) curDatosTemp.get(3);</span>
<span class="fc" id="L260">			Date fechafin = (Date) curDatosTemp.get(4);</span>
<span class="fc" id="L261">			double tasaMatricula = (Double) curDatosTemp.get(5);</span>
<span class="fc" id="L262">			int edicion = (Integer) curDatosTemp.get(6);</span>
<span class="fc" id="L263">			EstadoCurso estado = EstadoCurso.valueOf((String) curDatosTemp.get(7));</span>
<span class="fc" id="L264">			TipoCurso tipo = TipoCurso.valueOf((String) curDatosTemp.get(8));</span>
<span class="fc" id="L265">			Centro centro = new Centro((String) curDatosTemp.get(9));</span>
<span class="fc" id="L266">			ProfesorUCLM secretario = new ProfesorUCLM((String) curDatosTemp.get(10));</span>
<span class="fc" id="L267">			ProfesorUCLM directorObtenido = new ProfesorUCLM((String) curDatosTemp.get(11));</span>
<span class="fc" id="L268">			String requisitos = (String) curDatosTemp.get(12);</span>
			
<span class="fc" id="L270">			CursoPropio cursoDevolver = new CursoPropio(id, nombre, ECTS, fechainicio, fechafin, tasaMatricula, edicion, estado, tipo, centro, secretario, directorObtenido, requisitos);</span>
			
<span class="fc" id="L272">			List&lt;Materia&gt; materiasCurso = new Materia().materiaDao.listarMateriasPorCurso(cursoDevolver);</span>
<span class="fc" id="L273">			cursoDevolver.materias = materiasCurso;</span>
			
<span class="fc" id="L275">			List&lt;Matricula&gt; matriculasCurso = new Matricula().matriculaDAO.listarMatriculasPorCurso(cursoDevolver);</span>
<span class="fc" id="L276">			cursoDevolver.matriculas = matriculasCurso;</span>
			
<span class="fc" id="L278">			listaCursos.add(cursoDevolver);</span>
		}

<span class="fc" id="L281">		return listaCursos;	</span>
	}

	public double listarIngresos(TipoCurso tipo, Date fechaInicio, Date fechaFin) throws SQLException {
<span class="fc" id="L285">		Vector listaCursos = GestorBD.getInstancia().select(&quot;SELECT * FROM cursoPropio WHERE tipoCurso = '&quot;+ tipo.toString() +&quot;' AND fechaInicio &gt;= '&quot; + dateFormat.format(fechaInicio) + &quot;' AND fechaFin &lt;= '&quot; + dateFormat.format(fechaFin) + &quot;'&quot;);</span>
		
<span class="fc" id="L287">		double ingresosTotales = 0;</span>
		
<span class="pc bpc" id="L289" title="1 of 2 branches missed.">		for (int i=0; i&lt;listaCursos.size(); i++) {</span>
<span class="nc" id="L290">			Vector datosCursoTemp = (Vector) listaCursos.get(i);</span>
			
<span class="nc" id="L292">			String id = (String) datosCursoTemp.get(0);</span>
<span class="nc" id="L293">			int edicion = (Integer) datosCursoTemp.get(6);</span>
<span class="nc" id="L294">			double tasaMatricula = (Double) datosCursoTemp.get(5);</span>
			
<span class="nc" id="L296">			CursoPropio cursoTemp = new CursoPropio(id, edicion);</span>
			
<span class="nc" id="L298">			List&lt;Matricula&gt; matriculasCurso = new Matricula().matriculaDAO.listarMatriculasPorCurso(cursoTemp);</span>
			
<span class="nc bnc" id="L300" title="All 2 branches missed.">			for (int j = 0; j&lt;matriculasCurso.size();j++) {</span>
<span class="nc bnc" id="L301" title="All 2 branches missed.">				if (matriculasCurso.get(j).isPagado())</span>
<span class="nc" id="L302">					ingresosTotales+=tasaMatricula;</span>
			}
		}		
		
<span class="fc" id="L306">		return ingresosTotales;</span>
	}

	public List&lt;CursoPropio&gt; listarEdicionesCursos(Date fechaInicio, Date fechaFin) throws SQLException {
<span class="nc" id="L310">		Vector listaEdicicionDatos = GestorBD.getInstancia().select(&quot;SELECT * FROM cursoPropio WHERE fechaInicio = '&quot; + dateFormat.format(fechaInicio) + &quot;' AND fechaFin &lt;= '&quot; + dateFormat.format(fechaFin) + &quot;'&quot;);</span>
		
<span class="nc" id="L312">		List&lt;CursoPropio&gt; listaEdiciones = new ArrayList&lt;&gt;();</span>
		
<span class="nc bnc" id="L314" title="All 2 branches missed.">		for (int i=0; i&lt;listaEdicicionDatos.size(); i++) {</span>
<span class="nc" id="L315">			Vector lEdicnDatosTemp = (Vector) listaEdicicionDatos.get(i);</span>
			
<span class="nc" id="L317">			String id = (String) lEdicnDatosTemp.get(0);</span>
<span class="nc" id="L318">			String nombre = (String) lEdicnDatosTemp.get(1);</span>
<span class="nc" id="L319">			int ECTS = (Integer) lEdicnDatosTemp.get(2);</span>
<span class="nc" id="L320">			Date fechainicio = (Date) lEdicnDatosTemp.get(3);</span>
<span class="nc" id="L321">			Date fechafin = (Date) lEdicnDatosTemp.get(4);</span>
<span class="nc" id="L322">			double tasaMatricula = (Double) lEdicnDatosTemp.get(5);</span>
<span class="nc" id="L323">			int edicion = (Integer) lEdicnDatosTemp.get(6);</span>
<span class="nc" id="L324">			EstadoCurso estado = EstadoCurso.valueOf((String) lEdicnDatosTemp.get(7));</span>
<span class="nc" id="L325">			TipoCurso tipo = TipoCurso.valueOf((String) lEdicnDatosTemp.get(8));</span>
<span class="nc" id="L326">			Centro centro = new Centro((String) lEdicnDatosTemp.get(9));</span>
<span class="nc" id="L327">			ProfesorUCLM secretario = new ProfesorUCLM((String) lEdicnDatosTemp.get(10));</span>
<span class="nc" id="L328">			ProfesorUCLM director = new ProfesorUCLM((String) lEdicnDatosTemp.get(11));</span>
<span class="nc" id="L329">			String requisitos = (String) lEdicnDatosTemp.get(12);</span>
			
<span class="nc" id="L331">			CursoPropio cursoDevolver = new CursoPropio(id, nombre, ECTS, fechainicio, fechafin, tasaMatricula, edicion, estado, tipo, centro, secretario, director, requisitos);</span>
			
<span class="nc" id="L333">			List&lt;Materia&gt; materiasCurso = new Materia().materiaDao.listarMateriasPorCurso(cursoDevolver);</span>
<span class="nc" id="L334">			cursoDevolver.materias = materiasCurso;</span>
			
<span class="nc" id="L336">			List&lt;Matricula&gt; matriculasCurso = new Matricula().matriculaDAO.listarMatriculasPorCurso(cursoDevolver);</span>
<span class="nc" id="L337">			cursoDevolver.matriculas = matriculasCurso;</span>
					
<span class="nc" id="L339">			listaEdiciones.add(cursoDevolver);</span>
		}
		
<span class="nc" id="L342">		return listaEdiciones;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>